# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(cache = TRUE)
knitr::opts_chunk$set(message = FALSE)
# Chunk 2
library(readr)
library(momentuHMM)
library(ggplot2)
library(dplyr)
library(lubridate)
library(data.tree)
# Reading the data
BlacktipB <- read_delim("data/BlacktipB.txt",
delim = "\t", escape_double = FALSE,
trim_ws = TRUE)
# Let's transform the date/time info into a proper time format
# In this case we need to extract the second of the day correspondent to each observation
BlacktipB = BlacktipB %>%
mutate(Time = as.POSIXct(Time,format = "%m/%d/%Y %H:%M")) %>%
mutate(hour_to_sec =  as.integer(seconds(hm(format(Time, format = "%H:%M"))))) %>%
group_by(Time) %>% mutate(sec = row_number()) %>% ungroup() %>%
mutate(sec = case_when(hour_to_sec == 53160 ~ as.integer(sec + 55),
TRUE ~ sec),
hour_to_sec = hour_to_sec + sec)
head(BlacktipB)
BlacktipB %>% ggplot(aes(Time,ODBA)) + geom_line()
BlacktipB = BlacktipB %>% filter(ODBA <= 2.0)
install.packages("DiagrammeR")
library(readr)
library(momentuHMM)
library(ggplot2)
library(dplyr)
library(lubridate)
library(data.tree)
library(DiagrammeR)
?momentuHMM
?fitHMM
?MIfitHMM
?fitHMM
plotPR(fit1_s2_long)
# identify most likely state using the Viterbi algorithm
BlacktipB$state <- viterbi(fit1)
?crawlWrap
